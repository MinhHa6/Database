USE [master]
GO
--- TAO CO SO DU LIEU CO LAB03
CREATE DATABASE LAB03 ON 
(NAME = Lab03,
    FILENAME = 'F:\Database\Lab03.mdf',
    SIZE = 50 MB,
    MAXSIZE = 200 MB,
    FILEGROWTH = 10 MB)
LOG ON
(NAME = Lab03_log,
    FILENAME = 'F:\Database\lab03log.ldf',
    SIZE = 10 MB,
    MAXSIZE = 200 MB,
    FILEGROWTH = 5 MB);
GO
-- TAO BAO DANH MUC VAT TU
CREATE TABLE VATTU (
MaVTu CHAR (4) PRIMARY KEY ,
TenVTu VARCHAR (100) ,
DVTinh VARCHAR (10),
PhanTran REAL )
--TAO BANG DANH MUC NHA CUNG CAP 
GO
CREATE TABLE NHACC (
MaNhaCC CHAR (3) PRIMARY KEY  NOT NULL ,
TenNhaCC VARCHAR (100) NOT NULL,
DiaChi VARCHAR (200) NOT NULL,
DienThoai VARCHAR (20) NULL)
---TAO BANG DON DAT HANG 
GO 
CREATE TABLE DONDH (
SoDH CHAR (4) NOT NULL PRIMARY KEY,
NgayDH DATETIME ,
MaNhaCC CHAR (3) NOT NULL)

-- TAO BANG CHI TIET DON HANG 
GO 
CREATE TABLE CTDONDH (
SoDH CHAR (4) NOT NULL ,
MaVTu CHAR (4) NOT NULL,
SLDat INT NOT NULL )

---TAO BANG PHIEU NHAP HANG 
GO 
CREATE TABLE PNHAP
(SoPn CHAR (4) PRIMARY KEY ,
NgayNhap DATETIME ,
SoDh CHAR (4) NOT NULL)
 ---TAO BANG CHI TIET PHIEU NHAP

 GO 
 CREATE TABLE CTPNHAP (
 SoPn CHAR (4)  NOT NULL,
 MaVTu  CHAR (4) NOT NULl,
 SLNhap INT NOT NULL ,
 DgNhap MONEY NOT NULL)
  
  ---TAO BANG PHIEU XUAT HANG 
  GO 
  CREATE TABLE PXUAT 
  (SoPx CHAR (4) NOT NULL PRIMARY KEY ,
  NgayXuat DATETIME ,
  TenKh VARCHAR (100) NOT NULL )
  ----TAO BANG CHI TIET XUAT HANG 
  GO 
CREATE TABLE CTPXUAT (
SoPx CHAR (4) NOT NULL PRIMARY KEY ,
MaVTu  CHAR (4) NOT NULL ,
SLXuat  INT NOT NULL,
DgXuat MONEY NOT NULL)

--- TAOBANG TON KHO 
GO
CREATE TABLE TONKHO (
NamThang CHAR (6) NOT NULL ,
MaVTu  CHAR (4) NOT NULL ,
SLDau INT NOT NULL,
TongSLN INT NOT NULL,
TongSLX INT NOT NULL,
SLCuoi INT )

-- INSERT DỮ LIỆU VÀO BẢNG VATTU
INSERT INTO VATTU (MaVTu, TenVTu, DVTinh, PhanTran) 
VALUES
('DD01', 'Dụng cụ D01', 'Cái', 10.5),
('DD02', 'Dụng cụ D02', 'Cái', 20.0),
('VD02', 'Vật liệu VD02', 'Kg', 15.2),
('TV14', 'Thiết bị TV14', 'Chiếc', 25.5),
('TV29', 'Thiết bị TV29', 'Chiếc', 30.0);

-- INSERT DỮ LIỆU VÀO BẢNG NHACC
INSERT INTO NHACC (MaNhaCC, TenNhaCC, DiaChi, DienThoai)
VALUES
('NCC1', 'Nhà cung cấp 1', 'Hà Nội', '0901234567'),
('NCC2', 'Nhà cung cấp 2', 'TP.HCM', '0912345678'),
('NCC3', 'Nhà cung cấp 3', 'Đà Nẵng', '0923456789');

-- INSERT DỮ LIỆU VÀO BẢNG DONDH
INSERT INTO DONDH (SoDH, NgayDH, MaNhaCC)
VALUES
('DH01', '2023-08-15', 'NCC1'),
('DH02', '2023-08-16', 'NCC2'),
('DH03', '2023-08-17', 'NCC3');

-- INSERT DỮ LIỆU VÀO BẢNG CTDONDH
INSERT INTO CTDONDH (SoDH, MaVTu, SLDat)
VALUES
('DH01', 'DD01', 10),
('DH01', 'DD02', 5),
('DH02', 'VD02', 20),
('DH03', 'TV14', 15);

-- INSERT DỮ LIỆU VÀO BẢNG PNHAP
INSERT INTO PNHAP (SoPn, NgayNhap, SoDh)
VALUES
('PN001', '2023-08-18', 'DH01'),
('PN002', '2023-08-19', 'DH02'),
('PN003', '2023-08-20', 'DH03');

-- INSERT DỮ LIỆU VÀO BẢNG CTPNHAP
INSERT INTO CTPNHAP (SoPn, MaVTu, SLNhap, DgNhap)
VALUES
('PN001', 'DD01', 10, 3500000),
('PN001', 'DD02', 5, 4500000),
('PN002', 'VD02', 20, 5000000),
('PN003', 'TV14', 15, 6000000);

-- INSERT DỮ LIỆU VÀO BẢNG PXUAT
INSERT INTO PXUAT (SoPx, NgayXuat, TenKh)
VALUES
('PX01', '2023-08-21', 'Khách hàng A'),
('PX02', '2023-08-22', 'Khách hàng B'),
('PX03', '2023-08-23', 'Khách hàng C');

-- INSERT DỮ LIỆU VÀO BẢNG CTPXUAT
INSERT INTO CTPXUAT (SoPx, MaVTu, SLXuat, DgXuat)
VALUES
('PX01', 'DD01', 2, 3500000),
('PX01', 'DD02', 1, 4500000),
('PX02', 'VD02', 5, 5000000),
('PX03', 'TV14', 3, 6000000);

-- INSERT DỮ LIỆU VÀO BẢNG TONKHO
INSERT INTO TONKHO (NamThang, MaVTu, SLDau, TongSLN, TongSLX, SLCuoi)
VALUES
('202301', 'DD01', 50, 10, 6, 54),
('202301', 'DD02', 30, 15, 7, 38),
('202301', 'VD02', 100, 30, 10, 120),
('202301', 'TV14', 20, 5, 0, 25),
('202301', 'TV29', 10, 12, 0, 22);

GO
